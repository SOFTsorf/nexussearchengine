<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>Gemini Animation zu WebM</title>
    <style>
        body { margin: 0; background: #000; color: white; display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; font-family: sans-serif; }
        canvas { border-radius: 15px; background: #000; }
        .ui { margin-top: 20px; display: flex; gap: 10px; }
        button { padding: 10px 20px; cursor: pointer; border: none; border-radius: 5px; font-weight: bold; }
        #recordBtn { background: #ea4335; color: white; }
        #stopBtn { background: white; color: black; display: none; }
    </style>
</head>
<body>

    <canvas id="canvas" width="600" height="600"></canvas>

    <div class="ui">
        <button id="recordBtn">Aufnahme starten</button>
        <button id="stopBtn">Stoppen & WebM Speichern</button>
    </div>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const recordBtn = document.getElementById('recordBtn');
        const stopBtn = document.getElementById('stopBtn');

        let mediaRecorder;
        let recordedChunks = [];
        let time = 0;

        // --- ANIMATIONS-LOGIK ---
        function draw() {
            ctx.fillStyle = 'black';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            const x = canvas.width / 2;
            const y = canvas.height / 2;
            const size = 120 + Math.sin(time * 0.05) * 10;

            ctx.save();
            ctx.translate(x, y);
            ctx.rotate(time * 0.01);
            
            // Stern-Form
            ctx.beginPath();
            ctx.moveTo(0, -size);
            ctx.quadraticCurveTo(0, 0, size, 0);
            ctx.quadraticCurveTo(0, 0, 0, size);
            ctx.quadraticCurveTo(0, 0, -size, 0);
            ctx.quadraticCurveTo(0, 0, 0, -size);
            
            // Verlauf
            const grad = ctx.createRadialGradient(0, 0, 0, 0, 0, size);
            grad.addColorStop(0, '#4285F4');
            grad.addColorStop(1, '#34A853');
            
            ctx.shadowBlur = 30;
            ctx.shadowColor = '#4285F4';
            ctx.fillStyle = grad;
            ctx.fill();
            ctx.restore();

            time++;
            requestAnimationFrame(draw);
        }
        draw();

        // --- EXPORT-LOGIK (WebM) ---
        recordBtn.onclick = () => {
            recordedChunks = [];
            // Stream vom Canvas erfassen (30 FPS)
            const stream = canvas.captureStream(30);
            mediaRecorder = new MediaRecorder(stream, { mimeType: 'video/webm;codecs=vp9' });

            mediaRecorder.ondataavailable = (e) => {
                if (e.data.size > 0) recordedChunks.push(e.data);
            };

            mediaRecorder.onstop = () => {
                const blob = new Blob(recordedChunks, { type: 'video/webm' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'gemini_animation.webm';
                a.click();
            };

            mediaRecorder.start();
            recordBtn.style.display = 'none';
            stopBtn.style.display = 'block';
        };

        stopBtn.onclick = () => {
            mediaRecorder.stop();
            recordBtn.style.display = 'block';
            stopBtn.style.display = 'none';
        };
    </script>
</body>
</html>
